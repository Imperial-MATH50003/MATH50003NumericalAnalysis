----

**Problem 4** Derive  Backward Euler: use the left-sided divided difference approximation
$$
u'(x) â‰ˆ {u(x) - u(x-h)  \over h}
$$
to reduce the first order ODE
$$
\meeq{
u(a) =  c, \qquad u'(x) + Ï‰(x) u(x) = f(x)
}
$$
to a lower triangular system by discretising on the grid $x_j = a + j h$ for $h = (b-a)/n$. Hint: only impose the ODE on the
gridpoints $x_1,â€¦,x_n$ so that the divided difference does not depend on behaviour at $x_{-1}$.


**SOLUTION**

We go through all 4 steps (this is to help you understand what to do. In an exam I will still give full credit if you get the right result,
even if you don't write down all 4 steps):

(Step 1) Since we need to avoid going off the left in step 2 we start the ODE discretisation at $x_1$:
$$
\Vectt[u(x_0), u'(x_1) +  Ï‰(x_1)u(x_1), â‹®, u'(x_n) +  Ï‰(x_n)u(x_n)] = \underbrace{\Vectt[c, f(x_1),â‹®,f(x_n)]}_{ğ›}
$$

(Step 2) Replace with divided differences:
$$
\Vectt[u(x_0), (u(x_1)-u(x_0))/h +  Ï‰(x_1)u(x_1), â‹®, (u(x_n)-u(x_{n-1}))/h +  Ï‰(x_n)u(x_n)] â‰ˆ ğ›
$$

(Step 3) Replace with discrete system with equality:
$$
\Vectt[u_0, (u_1-u_0)/h +  Ï‰(x_1)u_1, â‹®, (u_n-u_{n-1}))/h +  Ï‰(x_n)u_n] = ğ›
$$

(Step 4) Write as linear system:
$$
\begin{bmatrix}
1 \\
-1/h & 1/h + Ï‰(x_1) \\
& â‹± & â‹± \\
&& -1/h & 1/h + Ï‰(x_n)
\end{bmatrix} \Vectt[u_0,â‹®,u_n] = ğ›
$$


**END**


**Problem 5** Reduce a SchrÃ¶dinger equation to a tridiagonal linear system by discretising on the grid $x_j = a + j h$ for $h = (b-a)/n$:
$$
\meeq{
u(a) =  c,\qquad u''(x) + V(x) u(x) = f(x), \qquad u(b) = d.
}
$$

**SOLUTION**

(Step 1) 
$$
\Vectt[u(x_0), u''(x_1) + V(x_1) u(x_1), â‹®, u'(x_{n-1}) + V(x_{n-1}) u(x_{n-1}), u(x_n)] = \underbrace{\Vectt[c, f(x_1),â‹®,f(x_{n-1}), d]}_{ğ›}
$$

(Step 2) Replace with divided differences:
$$
\Vectt[u(x_0), (u(x_0)-2u(x_1)+u(x_2))/h^2 + V(x_1)u(x_1), â‹®, (u(x_{n-2} - 2u(x_{n-1})+u(x_n))/h^2 + V(x_{n-1})u(x_{n-1}), u(x_n)] â‰ˆ ğ›
$$

(Step 3) Replace with discrete system with equality:
$$
\Vectt[u_0, (u_0-2u_1+u_2)/h^2 + V(x_1)u_1, â‹®, (u_{n-2}-2u_{n-1}+u_n))/h^2+ V(x_{n-1})u_{n-1},u_n] = ğ›
$$

(Step 4) Write as a tridiagonal linear system:
$$
\begin{bmatrix}
1 \\
1/h^2 & V(x_1)-2/h^2 & 1/h^2 \\
& â‹± & â‹± & â‹± \\
&&1/h^2 & V(x_{n-1})-2/h^2 & 1/h^2 \\
&& &&1
\end{bmatrix} \Vectt[u_0,â‹®,u_n] = ğ›
$$


**END**




