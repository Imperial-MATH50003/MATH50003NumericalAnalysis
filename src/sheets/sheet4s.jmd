**Numerical Analysis MATH50003 (2025â€“26) Problem Sheet 4**


**Problem 1** For intervals  $X = [a,b]$ and $Y = [c,d]$ satisfying
$0 < a < b$ and $0 < c < d$, and $n > 0$ prove that
$$
\meeq{
X/n = [a/n,b/n] \ccr
XY = [ac, bd]
}
$$
Generalise (without proof) these formulÃ¦ to the case $n < 0$ and to where there are no restrictions
on positivity of $a,b,c,d$. You may use the $\min$ or $\max$ functions.

**SOLUTION**

For $X/n$: if $x âˆˆ X$ then $a/n â‰¤ x/n â‰¤ b/n$ means $x/n âˆˆ [a/n,b/n]$. Similarly,
if $z âˆˆ [a/n,b/n]$ then $a â‰¤ nz â‰¤ b$ hence $nz âˆˆ X$ and therefore $z âˆˆ X/n$.

For $XY$: if $x âˆˆ X$ and $y âˆˆ Y$ then $ac â‰¤ xy â‰¤ bd$ means $xy âˆˆ [ac,bd]$.
Note $ac,bd âˆˆ XY$. To employ convexity we take logarithms. In particular
if $z âˆˆ [ac,bd]$ then $\log a + \log c â‰¤ \log z â‰¤ \log b + \log d$. Hence write
$$
\log z = (1-t) (\log a + \log c) + t (\log b + \log d) =
        \underbrace{(1-t)\log a + t \log b}_{\log x} + \underbrace{(1-t)\log c + t \log d}_{\log y}
$$
i.e. we have $z = xy$ where
$$
\meeq{
x = \exp((1-t)\log a + t \log b) = a^{1-t} b^t âˆˆ X \ccr
y = \exp((1-t)\log c + t \log d) = c^{1-t} d^t âˆˆ Y.
}
$$

The generalisation to negative cases proceeds by being a bit careful
with the signs. Eg if $n < 0$ we need to swap the order hence we get:
$$
A/n =  \begin{cases}
[a/n,b/n] & n > 0  \\
[b/n,a/n] & n < 0
\end{cases}
$$

For multiplication we just use $\min$ and $\max$ in a naive fashion:
$$
AB = [\min(ac,ad,bc,bd), \max(ac,ad,bc,bd)].
$$

**END**


**Problem 2(a)** Compute the following floating point interval arithmetic
expression assuming half-precision $F_{16}$ arithmetic:
$$
[1,1] âŠ– ([1,1] âŠ˜ 6)
$$
Hint: it might help to write $1 = (0.1111â€¦)_2$ when doing subtraction.

**SOLUTION**
Note that
$$
{1 \over 6} = {1 \over 2} {1\over 3} = 2^{-3} (1.010101â€¦)_2
$$
Thus
$$
[1,1] âŠ˜ 6 = 2^{-3} [(1.0101010101)_2, (1.0101010110)_2]
$$
And hence
$$
\meeq{
[1,1] âŠ– ([1,1] âŠ˜ 6) = [1,1] âŠ– [(0.0010101010101)_2, (0.0010101010110)_2] \ccr
= [{\rm fl}^{\rm down}(0.11010101010\magenta{011111â€¦})_2, {\rm fl}^{\rm up}(0.11010101010\magenta{10111111â€¦})_2] \ccr
= 2^{-1}[(1.1010101010)_2, (1.1010101011)_2] = [0.8330078125,0.83349609375]
}
$$

**END**


**Problem 2(b)** Writing
$$
\sin\ x = âˆ‘_{k=0}^n {(-1)^k x^{2k+1} \over (2k+1)!} + Î´_{x,2n+1}
$$
Prove the bound $|Î´_{x,2n+1}| â‰¤ 1/(2n+3)!$, assuming $x âˆˆ [0,1]$.

**SOLUTION**

We have from Taylor's theorem up to order $x^{2n+2}$:
$$
\sin\ x = âˆ‘_{k=0}^n {(-1)^k x^{2k+1} \over (2k+1)!} + \underbrace{{\sin^{2n+3}(t) x^{2n+3} \over (2n+3)!}}_{Î´_{x,2n+1}}.
$$
The bound follows since all derivatives of $\sin$ are bounded by 1 and we have assumed $|x| â‰¤ 1$.

**END**


**Problem 2(c)** Combine the previous parts to prove that:
$$
\sin 1 âˆˆ [(0.11010011000)_2, (0.11010111101)_2] = [0.82421875, 0.84228515625]
$$
You may use without proof that $1/120 = 2^{-7} (1.000100010001â€¦)_2$.

**SOLUTION**
Using $n = 1$ we have
$$
âˆ‘_{k=0}^1 {(-1)^k x^{2k+1} \over (2k+1)!} = x - {x^2 \over 3!} âˆˆ x âŠ– ((x âŠ— x) âŠ˜ 6).
$$
Noting that in floating point $1 âŠ— 1 = 1$ (ie it is exact) we compute
$$
\begin{align*}
\sin 1 &âˆˆ [1,1] âŠ– [1,1] âŠ˜ 6 âŠ• [{\rm fl}^{\rm down}(-1/120), {\rm fl}^{\rm up}(1/120)] \ccr
 = [(0.11010101010)_2, (0.11010101011)_2] âŠ• [-(0.00000010001000101)_2, (0.00000010001000101)_2] \ccr
  =
[{\rm fl}^{\rm down}(0.11010011000\magenta{11101011â€¦})_2,
 {\rm fl}^{\rm up}(0.11010111100\magenta{000101})_2] \ccr
 = [(0.11010011000)_2, (0.11010111101)_2] = [0.82421875, 0.84228515625]
\end{align*}
$$

**END**

-----

**Problem 3** For $A âˆˆ F_{âˆž,S}^{n Ã— n}$ and $ð± âˆˆ F_{âˆž,S}^n$ consider the error
in approximating matrix multiplication with idealised floating point: for
$$
A ð± =  \begin{pmatrix}
â¨_{j=1}^n A_{1,j} âŠ— x_j\\
â‹® \\
â¨_{j=1}^n A_{1,j} âŠ— x_j
\end{pmatrix} + Î´
$$
use Problem 8 on PS3 to show that
$$
\| Î´ \|_âˆž â‰¤ 2 \|A\|_âˆž \| ð± \|_âˆž E_{n,Ïµ_{\rm m}/2}
$$
for $E_{n,Ïµ} := {n Ïµ \over 1-nÏµ}$,
where  $n Ïµ_{\rm m} < 2$ and the matrix norm is $\|A \|_âˆž := \max_k âˆ‘_{j=1}^n |a_{kj}|$.



**SOLUTION**
We have for the $k$=th row
$$
â¨_{j=1}^n A_{k,j} âŠ— x_j =  â¨_{j=1}^n A_{k,j} x_j (1+Î´_j) = 
âˆ‘_{j=1}^n A_{k,j} x_j (1+Î´_j) + Ïƒ_{k,n}
$$
where we know $|Ïƒ_n| â‰¤ M_k E_{n-1,Ïµ_{\rm m}/2}$, where from 1(b) we have
$$
M_k = Î£_{j=1}^n |A_{k,j}x_j (1+Î´_j)| = Î£_{j=1}^n |A_{k,j}| |x_j| (1+|Î´_j|)  â‰¤ 2 \max |x_j| Î£_{j=1}^n |A_{k,j}|
â‰¤ 2 \|ð±\|_âˆž \|A \|_âˆž
$$
Similarly, we also have 
$$
|âˆ‘_{j=1}^n A_{k,j} x_j Î´_j| â‰¤ \|ð±\|_âˆž \|A \|_âˆž Ïµ_{\rm m}/2
$$
and so the result follows from
$$
Ïµ_{\rm m}/2 + 2E_{n-1,Ïµ_{\rm m}/2} â‰¤ {Ïµ_{\rm m}/2 + Ïµ_{\rm m} (n-1) \over 1-(n-1)Ïµ_{\rm m}/2} â‰¤ {Ïµ_{\rm m} n \over 1-nÏµ_{\rm m}/2} = 2E_{n,Ïµ_{\rm m}/2}.
$$
**END**
