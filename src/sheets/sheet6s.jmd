**Numerical Analysis MATH50003 (2024â€“25) Problem Sheet 6**




**Problem 1(a)** Show for a unitary matrix $Q âˆˆ U(n)$ and a vector $ğ± âˆˆ â„‚^n$ that multiplication by $Q$ preserve the 2-norm: $\|Q ğ±\| = \|ğ±\|.$

**SOLUTION**
$$
\|Q ğ±\|^2 = (Q ğ±)^â‹† Q ğ± = ğ±^â‹† Q^â‹† Q ğ± = ğ±^â‹†  ğ± = \|ğ±\|^2
$$
**END**

**Problem 1(b)** Show that the eigenvalues $Î»$ of a unitary matrix $Q$ are
on the unit circle: $|Î»| = 1$. Hint: recall for any eigenvalue $Î»$ that there exists a unit eigenvector
$ğ¯ âˆˆ â„‚^n$ (satisfying $\| ğ¯ \| = 1$). 

**SOLUTION**
Let $ğ¯$ be a unit eigenvector corresponding to $Î»$: $Q ğ¯ = Î» ğ¯$ with $\|ğ¯\| = 1$. Then
$$
1 = \| ğ¯ \| = \|Q ğ¯ \| =  \| Î» ğ¯ \| = |Î»|.
$$

**END**

**Problem 1(c)** Show for an orthogonal matrix $Q âˆˆ O(n)$ that $\det Q = Â±1$.
Give an example of $Q âˆˆ U(n)$ such that $\det Q â‰  Â±1$.
Hint: recall for any real matrices $A$ and $B$ that $\det A = \det A^âŠ¤$ and
$\det(AB) = \det A \det B$.

**SOLUTION**

$$
(\det Q)^2 = (\det Q^âŠ¤)(\det Q) = \det Q^âŠ¤Q = \det I = 1.
$$
An example would be a 1 Ã— 1 complex-valued matrix $\exp({\rm i})$.

**END**

**Problem 1(d)** A normal matrix commutes with its adjoint. Show that $Q âˆˆ U(n)$ is normal.

**SOLUTION**
$$
 QQ^â‹† = I = Q^â‹†Q
$$
**END**

**Problem 1(e)** 
The spectral theorem states that any normal matrix is unitarily diagonalisable: if $A$ is normal then $A = V Î› V^â‹†$
where $V âˆˆ U(n)$ and $Î›$ is diagonal.
Use this to show that  $Q âˆˆ U(n)$ is equal to $I$ if and only if all its eigenvalues are 1.

**SOLUTION**

Note that $Q$ is normal and therefore by the spectral theorem for 
normal matrices we have
$$
Q = V Î› V^â‹† = V V^â‹† = I
$$
since $V$ is unitary. 

**END**

-----
**Problem 2** Consider the vectors
$$
ğš = \begin{bmatrix} 1 \\ 2 \\ 2 \end{bmatrix}\qquad\hbox{and}\qquad  ğ› = \begin{bmatrix} 1 \\ 2{\rm i} \\ 2 \end{bmatrix}.
$$
Use reflections to determine the entries of orthogonal/unitary matrices $Q_1, Q_2, Q_3$ such that
$$
Q_1 ğš = \begin{bmatrix} 3 \\ 0 \\ 0 \end{bmatrix}, Q_2 ğš = \begin{bmatrix} -3 \\ 0 \\ 0 \end{bmatrix},
Q_3 ğ› = \begin{bmatrix} -3 \\ 0 \\ 0 \end{bmatrix}
$$

**SOLUTION**

For $Q_1$: we have
$$
\begin{align*}
ğ² &= ğš - \| ğš\| ğ_1 =  \begin{bmatrix} -2 \\ 2 \\ 2 \end{bmatrix} \\
ğ° &= {ğ² \over \|ğ²\|} = {1 \over \sqrt{3}} \begin{bmatrix} -1 \\ 1 \\ 1 \end{bmatrix} \\
Q_1 &= Q_{ğ°} = I - {2 \over 3} \begin{bmatrix} -1 \\ 1 \\ 1 \end{bmatrix}  [-1\ 1\ 1] = 
I - {2 \over 3} \begin{bmatrix} 1 & -1 & -1 \\ -1 & 1 & 1 \\ -1 & 1 & 1 \end{bmatrix} \\
&={1 \over 3} \begin{bmatrix} 1 & 2 & 2 \\ 2 & 1 & -2 \\ 2 & -2 & 1 \end{bmatrix} 
\end{align*}
$$

For $Q_2$: we have
$$
\begin{align*}
ğ² &= ğš + \| ğš\| ğ_1 =  \begin{bmatrix} 4 \\ 2 \\ 2 \end{bmatrix} \\
ğ° &= {ğ² \over \|ğ²\|} = {1 \over \sqrt{6}} \begin{bmatrix} 2 \\ 1 \\ 1 \end{bmatrix} \\
Q_2 &= Q_{ğ°} = I - {1 \over 3} \begin{bmatrix} 2 \\ 1 \\ 1 \end{bmatrix}  [2\ 1\ 1] = 
I - {1 \over 3} \begin{bmatrix} 4 & 2 & 2 \\ 2 & 1  & 1 \\ 2&  1 & 1 \end{bmatrix} \\
&={1 \over 3} \begin{bmatrix} -1 & -2 & -2 \\ -2& 2 &-1 \\ -2& -1& 2 \end{bmatrix} 
\end{align*}
$$

For $Q_3$ we just need to be careful to conjugate:
$$
\begin{align*}
ğ² &= ğ› + \| ğ›\| ğ_1 =  \begin{bmatrix} 4 \\ 2{\rm i} \\ 2 \end{bmatrix} \\
ğ° &= {ğ² \over \|ğ²\|} = {1 \over \sqrt{6}} \begin{bmatrix}2 \\ {\rm i} \\ 1 \end{bmatrix} \\
Q_3 &= Q_{ğ°} = I - {1 \over 3} \begin{bmatrix} 2 \\ {\rm i} \\ 1 \end{bmatrix}  [2\ -{\rm i}\ 1] = 
I - {1 \over 3} \begin{bmatrix} 4 & -2{\rm i} & 2 \\ 
                                2{\rm i}& 1 & {\rm i} \\ 
                                2 &-{\rm i} & 1 \end{bmatrix} \\
&={1 \over 3} \begin{bmatrix} -1 & 2{\rm i} & -2 \\ 
                            -2{\rm i} & 2 & -{\rm i} \\ 
                            -2& {\rm i} & 2 \end{bmatrix} 
\end{align*}
$$



**END**

**Problem 3** What simple rotation matrices $Q_1,Q_2 âˆˆ SO(2)$ have the property that:
$$
Q_1 \begin{bmatrix} 1 \\ 2 \end{bmatrix} =\begin{bmatrix} \sqrt{5} \\ 0 \end{bmatrix},  Q_2 \begin{bmatrix} \sqrt{5} \\ 2 \end{bmatrix} =  \begin{bmatrix} 3 \\ 0 \end{bmatrix}
$$

**SOLUTION**

The rotation that takes $[x,y]$ to the x-axis is
$$
{1 \over \sqrt{x^2+y^2}} \begin{bmatrix}
x & y \\
-y & x
\end{bmatrix}.
$$
Hence we get
$$
\begin{align*}
Q_1 &= {1 \over \sqrt{5}} \begin{bmatrix} 1 & 2 \\ -2 & 1 \end{bmatrix} \\
Q_2 &= {1 \over 3} \begin{bmatrix} \sqrt{5} & 2 \\ -2 & \sqrt{5} \end{bmatrix}
\end{align*}
$$


**END**

----

**Problem 4** Use Householder reflections to compute QR and reduce QR factorisations of the matrix
$$
A = \begin{bmatrix} -1 & 2 \\ 
2 & 4 \\ 
2 & 3 \end{bmatrix}.
$$

**SOLUTION**
Because the first entry has negative sign we have
$$
ğ²_1 = \Vectt[-1,2,2] - 3\Vectt[1,0,0] = \Vectt[-4,2,2] â‡’ ğ°_1 = {1 \over \sqrt{6}} \Vectt[-2,1,1].
$$
Hence
$$
Q_1 = I - 2ğ°_1 ğ°_1^âŠ¤ = \begin{bmatrix} -1 & 2 & 2 \\ 2 & 2 & -1 \\ 2 & -1 & 2 \end{bmatrix}/3
$$
Note that
$$
Q_1 ğš_2 = ğš_2 - {1 \over 3}  \Vectt[-2,1,1] (-4 + 4 + 3) = \Vectt[4, 3, 2].
$$
thus
$$
 A = Q_1\sopmatrix{3 & 4 \\ & 3 \\ & 2}
$$
Continuing we have $A_2 = [3,2]$ hence construct
$$
ğ²_2 = \Vectt[3,2] + \sqrt{13}\Vectt[1,0] = \Vectt[3+\sqrt{13},2] â‡’ ğ°_2 = {1 \over \sqrt{26+6\sqrt{13}}} \Vectt[3+\sqrt{13},2].
$$
Hence
$$
Q_2 = I - 2 ğ°_2 ğ°_2^âŠ¤ = \begin{bmatrix} -9-3\sqrt{13} & -6-2\sqrt{13} \\ 
                                         -6-2\sqrt{13} & 9+3\sqrt{13} \end{bmatrix}/(13+3\sqrt{13})
$$
and we have
$$
A = \underbrace{Q_1 \begin{bmatrix} 1 \\ & Q_2 \end{bmatrix}}_Q \begin{bmatrix}3 & 4 \\ & -\sqrt{13} \\ & 0 
\end{bmatrix}
$$
where
$$
Q = \begin{bmatrix} -1 & -30-10\sqrt{13} & 6+2\sqrt{13} \\
            2 & -12-4\sqrt{13} & -21-7\sqrt{13} \\
            2 & -3-\sqrt{13} & 24+8\sqrt{13} \end{bmatrix} \begin{bmatrix} 1/3 \\ & 1/(3(13+3\sqrt{13})) \\ && 1/(3(13+3\sqrt{13})) \end{bmatrix}
$$
The reduced QR factorisation comes from dropping the last column of $Q$ and row of $R$:
$$
A = \underbrace{\begin{bmatrix} -1 & -30-10\sqrt{13}  \\
            2 & -12-4\sqrt{13}  \\
            2 & -3-\sqrt{13}  \end{bmatrix} \begin{bmatrix} 1/3 \\ & 1/(3(13+3\sqrt{13})) \end{bmatrix}}_{QÌ‚} 
            \underbrace{\begin{bmatrix}3 & 4 \\ & -\sqrt{13} 
\end{bmatrix}}_{RÌ‚}
$$



**END**

**Problem 5(a)** Show that every matrix $A âˆˆ â„^{m Ã— n}$ has a  QR factorisation such that the diagonal of $R$ is non-negative.
Make sure to include the case of more columns than rows (i.e. $m < n$). 

**SOLUTION**

We first show for $m < n$ that a QR decomposition exists. Writing
$$
A = [ğš_1 | â‹¯ | ğš_n]
$$
and taking the first $m$ columns (so that it is square) we can write $[ğš_1 | â‹¯ | ğš_m] = Q R_m$. It follows that $R := Q^â‹† A$ is right-triangular.

We can write:
$$
D = \begin{bmatrix} \hbox{sign}(r_{11}) \\ & â‹±  \\ && \hbox{sign}(r_{pp}) \end{bmatrix}
$$
where $p = \min(m,n)$ and we define $\hbox{sign}(0) = 1$. Note that $D^âŠ¤ D = I$. Thus we can write:
$A = Q R = Q D D R$
where $(QD)$ is orthogonal and $DR$ is upper-triangular with positive entries.


**END**

**Problem 5(b)** Show that the QR factorisation of a square invertible matrix $A âˆˆ â„^{n Ã— n}$ is unique,
provided that the diagonal of $R$ is positive.

**SOLUTION**

Assume there is a second factorisation also with positive diagonal
$$
A = QR = \Qt  \Rt
$$
Then we know
$$
Q^âŠ¤ \Qt  = R \Rt^{-1}
$$
Note $Q^âŠ¤ \Qt $ is a product of orthogonal matrices so is also orthogonal. It's eigenvalues are
the same as $R \Rt^{-1}$, which is upper triangular. The eigenvalues of an upper triangular matrix are the diagonal
entries, which in this case are all positive. Since all eigenvalues of an orthogonal matrix are on the unit circle
(see Q1(b) above) we know all $m$ eigenvalues of
$Q^âŠ¤ \Qt$ are 1. By Q1(e) above, this means that $Q^âŠ¤ \Qt  = I$. Hence
$$
\Qt = (Q^âŠ¤)^{-1} = Q
$$
and
$$
\Rt = (\Qt)^{-1}A =  R.
$$
**END**



