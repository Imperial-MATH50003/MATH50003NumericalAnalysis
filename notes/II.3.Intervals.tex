
\section{Interval Arithmetic}
We will now see how the details of floating point arithmetic give us a means of performing \emph{computer-assisted proofs}, essentially turning the computer into a rigorous mathematician who can do millions (or even billions) of inequalities in seconds.  To do this we will  use the ability to set the rounding mode of floating point arithmetic  to establish bounds. As an example we consider computing  the digits of $\E$ with rigorous error bounds. 

We first review set arithmetic. For sets $X,Y \ensuremath{\subseteq} \ensuremath{\bbR}$, the set arithmetic operations are defined as
\begin{align*}
X + Y &:= \{x + y : x \ensuremath{\in} X, y \ensuremath{\in} Y\}, \\
XY &:= \{xy : x \ensuremath{\in} X, y \ensuremath{\in} Y\}, \\
X/Y &:= \{x/y : x \ensuremath{\in} X, y \ensuremath{\in} Y\}
\end{align*}
We will use floating point arithmetic to construct approximate set operations $\ensuremath{\oplus}$, $\ensuremath{\otimes}$ so that
\begin{align*}
  X + Y &\ensuremath{\subseteq} X \ensuremath{\oplus} Y, \\
   XY &\ensuremath{\subseteq} X \ensuremath{\otimes} Y,\\
    X/Y &\ensuremath{\subseteq} X \ensuremath{\oslash} Y
    \end{align*}
thereby a complicated algorithm can be run on sets and the true result is guaranteed to be a subset of the output.

When our sets are intervals we can deduce simple formul\ensuremath{\ae} for basic arithmetic operations. For simplicity we only consider the case where all values are positive, leaving the generalisation to the problem sheet.

\begin{proposition}[interval bounds] For intervals  $X = [a,b]$ and $Y = [c,d]$ satisfying $0 < a \ensuremath{\leq} b$ and $0 < c \ensuremath{\leq} d$, and $n > 0$, we have:
\meeq{
X + Y = [a+c, b+d] \ccr
X/n = [a/n,b/n] \ccr
XY = [ac, bd]
}
\end{proposition}
\textbf{Proof} We first show $X+Y \ensuremath{\subseteq} [a+c,b+d]$. If $z \ensuremath{\in} X + Y$ then $z = x+y$ such that $a \ensuremath{\leq} x \ensuremath{\leq} b$ and $c \ensuremath{\leq} y \ensuremath{\leq} d$ and therefore $a + c \ensuremath{\leq} z \ensuremath{\leq} c + d$ and $z \ensuremath{\in} [a+c,b+d]$. Equality follows from convexity. First note that $a+c, b+d \ensuremath{\in} X+Y$. Any point $z \ensuremath{\in}  [a+b,c+d]$ can be written  as a convex combination of the two endpoints: there exists $0 \ensuremath{\leq} t \ensuremath{\leq} 1$ such that
\[
z = (1-t) (a+c) + t (b+d) =  \underbrace{(1-t) a + t b}_x + \underbrace{(1-t) c + t d}_y
\]
Because intervals are convex we have $x \ensuremath{\in} X$ and $y \ensuremath{\in} Y$ and hence $z \ensuremath{\in} X+Y$. 

The remaining two proofs are left for the problem sheet. 

\ensuremath{\QED}

We want to  implement floating point variants of these operations that are guaranteed to contain the true set arithmetic operations.  We note that if we round the bottom  of an interval down and the top of an interval up, then the actual interval is guaranteed to lie inside the resulting interval with rounded endpoints.  We can implement this idea using rounded floating point arithmetic:

\begin{definition}[floating point interval arithmetic] For intervals  $A = [a,b]$ and $B = [c,d]$ satisfying $0 < a \ensuremath{\leq} b$ and $0 < c \ensuremath{\leq} d$, and $n > 0$, define:
\begin{align*}
[a,b] \ensuremath{\oplus} [c,d] &:= [\fldown(a+c), \flup(b+d)] \\
[a,b] \ensuremath{\ominus} [c,d] &:= [\fldown(a-d), \flup(b-c)] \\
[a,b] \ensuremath{\oslash} n &:= [\fldown(a/n), \flup(b/n)] \\
[a,b] \ensuremath{\otimes} [c,d] &:= [\fldown(ac), \flup(bd)]
\end{align*}
\end{definition}

We now explore this idea in pen-and-paper computations, in particular, to compute the exponential:

\begin{example}[small sum] consider evaluating the first few terms in the Taylor series of the exponential at $x = 1$ using interval arithmetic with half-precision $F_{16}$ arithmetic.  The first three terms are exact since all numbers involved are exactly floats, in particular if we evaluate $1 + x + x^2/2$ with $x = 1$ we get
\[
1 + 1 + 1/2 \ensuremath{\in} 1 \ensuremath{\oplus} [1,1] \ensuremath{\oplus} ([1,1] \ensuremath{\otimes} [1,1]) \ensuremath{\oslash} 2 = [5/2, 5/2]
\]
Noting that 
\[
1/6 = (1/3)/2 = 2^{-3} (1.01010101\ensuremath{\ldots})_2
\]
we can extend the computation to another term:
\begin{align*}
1 + 1 + 1/2 + 1/6 &\ensuremath{\in} [5/2,5/2] \ensuremath{\oplus} ([1,1] \ensuremath{\oslash} 6) \ccr
= [2 (1.01)_2, 2 (1.01)_2] \ensuremath{\oplus} 2^{-3}[(1.0101010101)_2, (1.0101010110)_2] \ccr
= [\fldown(2 (1.0101010101\red{0101})_2), \flup(2 (1.0101010101\red{011})_2)] \ccr
= [2(1.0101010101)_2, 2(1.0101010110)_2] \ccr 
= [2.666015625, 2.66796875]
\end{align*}
\end{example}

\begin{example}[exponential with intervals] Consider computing $\exp(x)$ for $0 \ensuremath{\leq} x \ensuremath{\leq} 1$ from the Taylor series approximation:
\[
\exp(x) = \sum_{k=0}^n {x^k \over k!} + \underbrace{\exp(t){x^{n+1} \over (n+1)!}}_{\ensuremath{\delta}_{x,n}}
\]
where we can bound the error by (using the fact that $\ensuremath{\euler} = 2.718\ensuremath{\ldots} \ensuremath{\leq} 3$, an inequality whose proof we leave as an exercise)
\[
|\ensuremath{\delta}_{x,n}| \ensuremath{\leq} {\exp(1) \over (n+1)!} \ensuremath{\leq} {3 \over (n+1)!}.
\]
Put another way: $\ensuremath{\delta}_{x,n} \ensuremath{\in} \left[-{3 \over (n+1)!}, {3 \over (n+1)!}\right]$. We can use this to adjust the bounds derived from interval arithmetic for the interval arithmetic expression:
\[
\exp(X) \ensuremath{\subseteq} \left(\ensuremath{\bigoplus}_{k=0}^n {X \ocaret k \ensuremath{\oslash} k!}\right) \ensuremath{\oplus} \left[\fldown\fpr(-{3 \over (n+1)!}), \flup\fpr({3 \over (n+1)!})\right]
\]
For example, with $n = 3$ we have $|\ensuremath{\delta}_{1,2}| \ensuremath{\leq} 3/4! = 1/2^3$. Thus we can prove that:
\meeq{
\ensuremath{\euler} = 1 + 1 + 1/2 + 1/6 + \ensuremath{\delta}_x \ensuremath{\in} [2(1.0101010101)_2, 2(1.0101010110)_2] \ensuremath{\oplus} [-1/2^3, 1/2^3] \ccr
= [2(1.0100010101)_2, 2(1.0110010110)_2] = [2.541015625,2.79296875]
}
\end{example}

\subsection{Lab and Problem Sheet}
In the lab we see how interval arithmetic with floating point numbers can be easily implemented by carefully setting the rounding mode. We also see how special functions like $\exp x$ can be implemented with rigorous bounds by combining computation with intervals with bounds on the Taylor series, turning the pen-and-paper example in these notes into an actual algorithm.  As a fun example we compute $\exp 1 \ensuremath{\equiv} \ensuremath{\euler}$ with rigorous bounds with as many as 1000 digits. This is a baby example of computer-assisted proofs, a concept that is increasingly important in pure mathematics and has been used for many important problems, including the proof of \href{https://en.wikipedia.org/wiki/Kepler_conjecture}{Kepler's conjecture}, which was unsolved with non-computer-based techniques for 400 years.

In the problem sheet we complete the proofs of airthmetic with intervals and explore the rigorous computation of special functions like $\sin 1$ using interval arithmetic by-hand. This helps to build understanding on what the computer is doing in the labs.



